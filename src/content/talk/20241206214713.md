---
id: 20241206214713
slug: svelte-eliminates-the-need-for-hoge
title: React使いが語る<wbr>Svelteなら<wbr>〇〇が要らない
author: totto2727
date: 2024-12-06
tags: [Svelte, React, TypeScript]
---

## まとめ

- clsxが要らない
- hoge.module.cssが要らない
- Framer Motionが要らない
- setHogeが要らない
- 状態管理ライブラリが要らない
- 依存配列が要らない
- pathpidaが要らない
- Tanstack Query（SWR）が要らない

---

## clsxが要らない

```svelte
<!-- These are equivalent -->
<div class={isCool ? "cool" : ""}>...</div>
<div class:cool={isCool}>...</div>

<!-- These are equivalent -->
<div style:color="red">...</div>
<div style="color: red">...</div>
```

---

## hoge.module.cssが要らない

```svelte
<style>
.bouncy {
	animation: bounce 10s;
}

/* these keyframes are only accessible inside this component */
@keyframes bounce {
	/* ... */
}
</style>
```

<t-align-center>しかも未使用のCSSを<br class="slide-only">静的解析で検出できる！</t-align-center>

---

### CSS変数の扱いに長けている

```svelte
<Slider
	bind:value
	min={0}
	max={100}
	--track-color="black"
	--thumb-color="rgb({r} {g} {b})"
/>
```

```svelte
<svelte-css-wrapper
	style="display: contents; --track-color: black; --thumb-color: rgb({ r } { g } { b })"
>
	<Slider
		bind:value
		min={0}
		max={100}
	/>
</svelte-css-wrapper>
```

<t-align-center>※ SliderコンポーネントのPropsに<br class="slide-only">渡すわけではない</t-align-center>

---

### もし構造を維持したいなら<wbr>（標準タグが使える場合）

```svelte
<input
	bind:value
	type="range"
	min={0}
	max={100}
	style:--track-color="black"
	style:--thumb-color="rgb({r} {g} {b})"
/>
```

---

## Framer Motionが要らない

### 表示非表示

```svelte
<script>
import { fade } from "svelte/transition";

let visible = $state(false);
</script>

<button onclick={() => visible = !visible}>toggle</button>

{#if visible}
	<div transition:fade>fades in and out</div>
{/if}
```

---

### リストのアニメーション

```svelte
<!-- When `list` is reordered the animation will run -->
{#each list as item, index (item)}
	<li animate:flip>{item}</li>
{/each}
```

---

## setHogeが要らない

```svelte
<script>
let count = $state(0);
</script>

<button onclick={() => count++}>
	clicks: {count}
</button>
```

いわゆるSignal的な実装

---

## 状態管理ライブラリが要らない

```js
export const myGlobalState = $state({
  user: {
    /* ... */
  },
  /* ... */
});
```

```svelte
<script>
import { myGlobalState } from "./state.svelte";
// ...
</script>;
```

<t-align-center>Signalはどこでも定義可能</t-align-center>

<t-align-center>自然とJotaiっぽくなる</t-align-center>

---

## 依存配列が要らない

### `$derived(useMemo)`

```svelte
<script>
let numbers = $state([1, 2, 3]);
let total = $derived.by(() => {
  let total = 0;
  for (const n of numbers) {
    total += n;
  }
  return total;
});
</script>

<button onclick={() => numbers.push(numbers.length + 1)}>
	{numbers.join(" + ")} = {total}
</button>
```

---

### `$effect(useEffect)`

```svelte
<script>
let size = $state(50);
let color = $state("#ff3e00");

let canvas;

$effect(() => {
  const context = canvas.getContext("2d");
  context.clearRect(0, 0, canvas.width, canvas.height);

  // this will re-run whenever `color` or `size` change
  context.fillStyle = color;
  context.fillRect(0, 0, size, size);
});
</script>

<canvas bind:this={canvas} width="100" height="100" />
```

<t-align-center>依存に含めたくない場合は<br class="slide-only">`untrack`関数を使います</t-align-center>

---

## pathpidaが要らない

要検証（まだ自分も把握しきれてない）

```svelte
<script lang="ts">
import type { PageData } from "./$types";

let { data }: { data: PageData } = $props();
</script>
```

<t-align-center>[https://svelte.dev/docs/kit/types](https://svelte.dev/docs/kit/types)</t-align-center>

---

## Tanstack Query（SWR）が<br>要らない

```svelte
{#await promise}
	<!-- promise is pending -->
	<p>waiting for the promise to resolve...</p>
{:then value}
	<!-- promise was fulfilled or not a Promise -->
	<p>The value is {value}</p>
{:catch error}
	<!-- promise was rejected -->
	<p>Something went wrong: {error.message}</p>
{/await}
```

revalidateなどが不要であればこれで十分

更新もシンプルなものなら<br class="slide-only">Promiseに再代入するだけでOK

---

## 仮想DOMが要らない

真なるリアクティブ

<t-align-center>[参考資料](https://speakerdeck.com/ssssota/the-next-chapter-of-declarative-ui)</t-align-center>

---

## 最後に

<div class="list">

<style>
	.reveal .list li {
		font-size: 0.85em;
		line-height: 1.5;

		li {
			font-size: 1em
		}
	}
</style>

- SvelteはWeb開発に必要なものを標準で揃えているイメージ
  - Reactでちょっと欲しくユーティリティが標準機能としてあるような印象
  - 小さいアプリならReactより少ない依存で解決できる気がする
- Svelte v5のRuneでReactに近い書き心地になっている
  - 今までHookのような定義は少し癖があった
- 学習コストはそんな高くない（ライフサイクルも素直）
- Svelte kitはまだあまり触れていないが、仕組み自体はかなりシンプル

</div>
